:root{
  /* Variables locales para reviews - usan la paleta global */
  --review-card-bg: var(--theme-card-background);
  --review-border: var(--border-color);
  --iframe-bg: #e74c3c;
  --review-shadow: var(--shadow-lg);
  --review-text-muted: var(--text-muted);
  --review-accent: var(--color-tab-primary);

  /* Tipografía alineada a EMBED */
  --fs-card-body:   0.9rem;
  --fs-sm:     0.85rem;
  --fs-xs:     0.75rem;
  --fs-stars:  1.1rem;

  --clamp-lines:6;   /* nº de líneas antes de “ver más” */
  --lh:1.6;          /* line-height base */
}

.review-card,.review-item{
  font-family:var(--bs-body-font-family, ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji");
}
*,*::before,*::after{ box-sizing:border-box; }

/* Grid */
.review-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(330px,1fr));
  gap:2rem;
}

/* Indicador segmentado para tarjetas del index */
.review-card .carousel-segments{
  display:flex; gap:8px; justify-content:center; align-items:center;
  margin:12px auto 0; width:100%;
}
.review-card .carousel-segment{
  appearance:none; border:0; padding:0; cursor:pointer;
  height:6px; flex:1 1 0; border-radius:4px;
  background:rgba(0,0,0,.12);
  transition:transform .15s ease, background-color .2s ease;
}
.review-card .carousel-segment:hover{ transform:translateY(-1px); }
.review-card .carousel-segment.is-active{ background:var(--color-button-primary); }

/* Título del tour */
.review-title{
  display:flex; align-items:center; justify-content:center;
  min-height:56px;
  background:var(--review-accent); color:#fff;
  padding:8px 14px; font-weight:800; font-size:1rem;
  border-radius:10px 10px 0 0; margin-bottom:1rem;
}
.review-title a{ color:#fff; text-underline-offset:2px; }

/* Card */
.review-card{
  display:flex; flex-direction:column; text-align:center;
  padding:1rem 1rem 0.75rem;
  position:relative; overflow:visible;
  border:1px solid var(--review-border); border-radius:12px;
  background:var(--review-card-bg);
  min-height:420px;
  transition:box-shadow .2s ease;
}
.review-card:hover{ box-shadow:var(--review-shadow); }
.review-card .js-carousel{ display:flex; flex-direction:column; flex:1 1 auto; }
.review-card .js-slides{  display:flex; flex-direction:column; flex:1 1 auto; }

/* Al expandir, deja crecer (y anula alturas fijas si las hubiera) */
.review-card.expanded-card{
  min-height:auto;
  height:auto !important;
}

/* Slide */
.review-item{ width:100%; }
.review-body-wrapper{
  width:100%;
  display:flex; flex-direction:column; align-items:center;
  gap:.55rem; padding:0 18px 2px;
}

/* Autor / fecha (alineado a embed) */
.review-header{
  display:flex; align-items:center; justify-content:center; margin-top:.25rem;
  gap:.5rem;
}
.review-meta{
  display:flex; flex-direction:column; align-items:center; gap:.2rem;
  min-width:0;
}
.review-author{
  font-weight:800; font-size:var(--fs-card-body); color:#1f2937;
  overflow-wrap:anywhere;
  word-break:break-word;
  text-align:center;
}
.review-date{ font-size:var(--fs-sm); color:var(--review-text-muted); line-height:1.15; }

/* Estrellas (alineado a embed) */
.review-stars{ color:#f1c40f; font-size:var(--fs-stars); line-height:1; letter-spacing:.02em; }
.rating-number{ color:var(--color-button-primary); margin-left:.35rem; font-weight: 600; font-size:var(--fs-card-body); }

/* Pill (alineado a embed) */
.review-label{
  display:block; width:100%;
  background:var(--iframe-bg); color:#fff;
  padding:.5rem 1rem; margin:.55rem 0 .35rem;
  font-weight:800; font-size:var(--fs-sm); text-align:center;
  border-radius:8px; word-break:break-word;
}

/* Texto con clamp */
.review-content{
  width:100%; color:#333; text-align:left;
  line-height:var(--lh); overflow:hidden;
  display:-webkit-box; -webkit-box-orient:vertical;
  -webkit-line-clamp:var(--clamp-lines);
  max-height:calc(var(--lh) * var(--clamp-lines) * 1em);
  transition:max-height .25s ease;
  font-size: var(--fs-card-body);
}
.review-content p{ margin:0; }
.review-content.expanded{
  -webkit-line-clamp:unset;
  max-height:1200px;
}

/* Fade-in iframe */
.review-embed { opacity: 0; transition: opacity .2s ease; }
.review-embed[data-ready="1"] { opacity: 1; }
.iframe-skeleton { transition: opacity .2s ease, visibility .2s ease; }
.iframe-skeleton.is-hidden { opacity: 0; visibility: hidden; }

/* Botón Ver más/menos */
.review-toggle{
  background:none; border:0; cursor:pointer;
  margin-top:.35rem;
  color:var(--color-button-primary);
  font-weight:700; font-size:.8rem; line-height:1.2;
}
.review-toggle:hover{ text-decoration:underline; color:var(--review-card-bg-title); }

/* Powered by */
.powered-by{ font-size:.8rem; color:#555; text-align:center; margin-top:.6rem; }

/* Navegación */
.carousel-buttons-row{ display:flex; justify-content:center; gap:2rem; margin-top:.8rem; }
.carousel-prev,.carousel-next{
  background:none; border:none; font-size:1.6rem; color:var(--review-card-bg-title);
  cursor:pointer; padding:0 .5rem; line-height:1;
}
.carousel-prev:hover,.carousel-next:hover{ color:var(--review-card-bg-title); }

/* ============ Normaliza ancho del IFRAME a 600px (como EMBED/HOME) ============ */
.review-card .iframe-shell{
  --w: 600px;
  max-width: var(--w);
  width: 100%;
  margin-inline: auto;
}
.review-card iframe.review-iframe{
  max-width: var(--w);
  width: 100%;
  display: block;
}

/* Iframes compactos (opt-in) */
.iframe-shell.small{
  position:relative;
  width:100%;
  height:var(--h,420px);
  transition:none;
}
.iframe-shell.small>iframe{
  width:100%;
  height:100%;
  border:0;
  display:block;
  overflow:hidden;
  background:transparent;
}
.iframe-skeleton{
  position:absolute;
  inset:0;
  border-radius:.75rem;
  background:#f4f4f4;
  animation:pulse 1.2s ease-in-out infinite;
}
@keyframes pulse{
  0%{opacity:.6}
  50%{opacity:1}
  100%{opacity:.6}
}

/* =========================
   RESPONSIVE — SOLO EN EL SITIO (no dentro del iframe)
   ========================= */
@media (max-width:768px){
  body:not([data-embed="1"]) .review-grid{ grid-template-columns:1fr; gap:1.2rem; }
  body:not([data-embed="1"]) .review-title{ min-height:48px; font-size:.95rem; }
  body:not([data-embed="1"]) .review-author{ font-size:var(--fs-card-body); }
  body:not([data-embed="1"]) .review-date{ font-size:var(--fs-sm); }
  body:not([data-embed="1"]) .review-label{ font-size:var(--fs-sm); padding:.4rem .8rem; }
  body:not([data-embed="1"]) .review-stars{ font-size:var(--fs-stars); }
  body:not([data-embed="1"]) .review-toggle{ font-size:.75rem; }
  body:not([data-embed="1"]) .powered-by{ font-size:.75rem; }

  /* Header se apila para evitar solapes */
  body:not([data-embed="1"]) .review-header{ flex-direction:column; gap:.25rem; }
  body:not([data-embed="1"]) .review-meta{ align-items:center; }
}

@media (max-width:424px){
  body:not([data-embed="1"]) .review-card{ padding:.8rem .8rem .6rem; }
  body:not([data-embed="1"]) .review-title{ font-size:.9rem; padding:.4rem .6rem; }
  body:not([data-embed="1"]) .review-author{ font-size:.9rem; }
  body:not([data-embed="1"]) .review-date{ font-size:.75rem; }
  body:not([data-embed="1"]) .review-label{ font-size:.8rem; }
}
